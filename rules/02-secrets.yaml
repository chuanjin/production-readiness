id: secrets-management
severity: high
category: security
title: Secrets likely stored as environment variables

description: >
  Secrets appear to be handled via environment variables without a
  dedicated secrets management solution.

why_it_matters:
  - Environment variables are often logged, dumped, or exposed by mistake.
  - Rotating env-based secrets usually requires redeployments.
  - Access control and auditing are typically missing.

detect:
  any_of:
    - file_exists: .env
    - code_contains: process.env
    - code_contains: os.environ
    - signal_equals:
        secrets_provider_detected: false

confidence: high

id: rollback-strategy
severity: high
category: deployment
title: No rollback strategy detected
description: >
  No explicit rollback strategy was detected in deployment configuration.
why_it_matters:
  - Most incidents are resolved by rollback, not by hotfix.
  - Hotfixes under pressure often introduce secondary failures.
  - If rollback is slow or impossible, MTTR explodes.
detect:
  none_of:
    - signal_equals:
        k8s_deployment_strategy: RollingUpdate
    - signal_equals:
        versioned_artifacts: true
    - code_contains: rollback
    - code_contains: "docker tag"
    - code_contains: "git tag"
    - file_exists: "**/*deployment*.yaml"
    - file_exists: "**/*deploy*.yml"
confidence: medium
